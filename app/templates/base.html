<!DOCTYPE html>
<html class="{{ 'dark' if theme == 'dark' else 'light' }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}NEXDB - Database Control Panel{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: {
              50: '#f0f9ff',
              100: '#e0f2fe',
              200: '#bae6fd',
              300: '#7dd3fc',
              400: '#38bdf8',
              500: '#0ea5e9',
              600: '#0284c7',
              700: '#0369a1',
              800: '#075985',
              900: '#0c4a6e',
            }
          }
        }
      }
    }
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  {% block head %}{% endblock %}
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen flex">
  <!-- Sidebar Navigation -->
  <aside class="w-64 bg-white dark:bg-gray-800 shadow-lg fixed h-full flex flex-col z-10 transition-all duration-300 ease-in-out" id="sidebar">
    <div class="p-4 flex items-center justify-between border-b dark:border-gray-700">
      <div class="flex items-center">
        <div class="w-10 h-10 flex items-center justify-center bg-primary-600 text-white rounded-lg mr-3">
          <i class="fas fa-database text-xl"></i>
        </div>
        <h1 class="text-xl font-bold">NEXDB</h1>
      </div>
      <button id="mobile-toggle" class="md:hidden text-gray-500 dark:text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
        <i class="fas fa-bars"></i>
      </button>
    </div>
    
    <nav class="flex-grow p-4 overflow-y-auto">
      <ul class="space-y-2">
        <!-- Dashboard -->
        <li>
          <a href="{{ url_for('dashboard.index') }}" class="flex items-center p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 group {{ 'bg-gray-100 dark:bg-gray-700' if request.endpoint.startswith('dashboard') else '' }}">
            <i class="fas fa-chart-line w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-500"></i>
            <span class="ml-3">Dashboard</span>
          </a>
        </li>
        
        <!-- Projects -->
        <li>
          <a href="{{ url_for('projects.index') }}" class="flex items-center p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 group {{ 'bg-gray-100 dark:bg-gray-700' if request.endpoint.startswith('projects') else '' }}">
            <i class="fas fa-project-diagram w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-500"></i>
            <span class="ml-3">Projects</span>
          </a>
        </li>
        
        <!-- Databases -->
        <li>
          <a href="{{ url_for('database.index') }}" class="flex items-center p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 group {{ 'bg-gray-100 dark:bg-gray-700' if request.endpoint.startswith('database') else '' }}">
            <i class="fas fa-server w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-500"></i>
            <span class="ml-3">Databases</span>
          </a>
        </li>
        
        <!-- Backups -->
        <li>
          <a href="{{ url_for('backup.index') }}" class="flex items-center p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 group {{ 'bg-gray-100 dark:bg-gray-700' if request.endpoint.startswith('backup') else '' }}">
            <i class="fas fa-save w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-500"></i>
            <span class="ml-3">Backups</span>
          </a>
        </li>
        
        <!-- Monitoring -->
        <li>
          <a href="#" class="flex items-center p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 group">
            <i class="fas fa-chart-bar w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-500"></i>
            <span class="ml-3">Monitoring</span>
          </a>
        </li>
        
        <!-- Settings Section Header -->
        <li class="pt-5">
          <div class="text-xs font-semibold text-gray-400 uppercase tracking-wider">Settings</div>
        </li>
        
        <!-- General Settings -->
        <li>
          <a href="{{ url_for('settings.index') }}" class="flex items-center p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 group {{ 'bg-gray-100 dark:bg-gray-700' if request.endpoint == 'settings.index' else '' }}">
            <i class="fas fa-cog w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-500"></i>
            <span class="ml-3">General</span>
          </a>
        </li>
        
        <!-- User Management -->
        <li>
          <a href="{{ url_for('user.index') }}" class="flex items-center p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 group {{ 'bg-gray-100 dark:bg-gray-700' if request.endpoint.startswith('user') else '' }}">
            <i class="fas fa-users w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-500"></i>
            <span class="ml-3">Users</span>
          </a>
        </li>
        
        <!-- Storage Providers -->
        <li>
          <a href="{{ url_for('settings.s3') }}" class="flex items-center p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 group {{ 'bg-gray-100 dark:bg-gray-700' if request.endpoint == 'settings.s3' else '' }}">
            <i class="fas fa-cloud w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-500"></i>
            <span class="ml-3">Storage Providers</span>
          </a>
        </li>
        
        <!-- Documentation -->
        <li>
          <a href="#" class="flex items-center p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 group">
            <i class="fas fa-book w-5 h-5 text-gray-500 dark:text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-500"></i>
            <span class="ml-3">Documentation</span>
          </a>
        </li>
      </ul>
    </nav>
    
    <div class="p-4 border-t dark:border-gray-700">
      <!-- Copy IP Button -->
      <button id="copy-ip" class="w-full flex items-center justify-between p-2 mb-3 text-sm rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
        <span class="flex items-center">
          <i class="fas fa-copy w-5 h-5 text-gray-500 dark:text-gray-400 mr-2"></i>
          <span class="text-sm">Copy Public IPv4</span>
        </span>
        <span id="ip-address" class="text-xs text-gray-500">{{ request.host.split(':')[0] }}</span>
      </button>
      
      <!-- Toggle Theme Button -->
      <a href="{{ url_for('user.toggle_theme') }}" class="w-full flex items-center p-2 mb-3 text-sm rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
        <i class="fas {% if theme == 'dark' %}fa-sun{% else %}fa-moon{% endif %} w-5 h-5 text-gray-500 dark:text-gray-400 mr-2"></i>
        <span>{% if theme == 'dark' %}Light Mode{% else %}Dark Mode{% endif %}</span>
      </a>
      
      <!-- Logout Button -->
      <a href="{{ url_for('auth.logout') }}" class="w-full flex items-center p-2 text-sm text-red-600 dark:text-red-500 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20">
        <i class="fas fa-sign-out-alt w-5 h-5 mr-2"></i>
        <span>Logout</span>
      </a>
    </div>
  </aside>
  
  <!-- Main Content -->
  <main class="ml-64 flex-grow min-h-screen transition-all duration-300 ease-in-out" id="main-content">
    <!-- Top Navigation Bar -->
    <header class="bg-white dark:bg-gray-800 shadow-sm p-4 flex items-center justify-between sticky top-0 z-5">
      <div class="flex items-center">
        <button id="sidebar-toggle" class="mr-4 text-gray-500 dark:text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
          <i class="fas fa-bars"></i>
        </button>
        <h2 class="text-xl font-semibold">{% block page_title %}Dashboard{% endblock %}</h2>
      </div>
      
      <div class="flex items-center space-x-3">
        <!-- Notifications -->
        <div class="relative">
          <button class="p-1 text-gray-500 dark:text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 relative">
            <i class="fas fa-bell"></i>
            <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"></span>
          </button>
        </div>
        
        <!-- User Profile -->
        <div class="flex items-center">
          <a href="{{ url_for('user.profile') }}" class="flex items-center space-x-2">
            <div class="w-8 h-8 bg-primary-600 text-white rounded-full flex items-center justify-center">
              <span class="font-medium">{{ session.get('username', 'U')[0].upper() }}</span>
            </div>
            <span class="hidden md:inline-block font-medium">{{ session.get('username', 'User') }}</span>
          </a>
        </div>
      </div>
    </header>
    
    <!-- Content Area -->
    <div class="p-6">
      <!-- Flash Messages -->
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="mb-6">
            {% for category, message in messages %}
              {% set alert_class = {
                'success': 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-500',
                'info': 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-500',
                'warning': 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-500',
                'danger': 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-500'
              } %}
              {% set icon_class = {
                'success': 'fa-check-circle',
                'info': 'fa-info-circle',
                'warning': 'fa-exclamation-triangle',
                'danger': 'fa-exclamation-circle'
              } %}
              <div class="p-4 mb-2 rounded-lg flex items-center {{ alert_class.get(category, 'bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-500') }}">
                <i class="fas {{ icon_class.get(category, 'fa-info-circle') }} mr-3"></i>
                <span>{{ message }}</span>
                <button class="ml-auto text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300" onclick="this.parentElement.remove()">
                  <i class="fas fa-times"></i>
                </button>
              </div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}
      
      <!-- Page Content -->
      {% block content %}{% endblock %}
    </div>
  </main>
  
  <script>
    // Sidebar toggle functionality
    document.getElementById('sidebar-toggle').addEventListener('click', function() {
      const sidebar = document.getElementById('sidebar');
      const mainContent = document.getElementById('main-content');
      
      sidebar.classList.toggle('-translate-x-full');
      mainContent.classList.toggle('ml-0');
      mainContent.classList.toggle('ml-64');
    });
    
    // Mobile sidebar toggle
    document.getElementById('mobile-toggle').addEventListener('click', function() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('-translate-x-full');
    });
    
    // Copy IP address functionality
    document.getElementById('copy-ip').addEventListener('click', function() {
      const ip = document.getElementById('ip-address').textContent;
      navigator.clipboard.writeText(ip).then(function() {
        alert('IP address copied to clipboard: ' + ip);
      });
    });
  </script>
</body>
</html> 