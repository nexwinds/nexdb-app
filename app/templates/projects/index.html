{% extends "base.html" %}

{% block title %}Projects - NEXDB{% endblock %}
{% block page_title %}Projects{% endblock %}

{% block content %}
<div class="space-y-6">
  <!-- Page Header & Actions -->
  <div class="flex flex-wrap items-center justify-between gap-4">
    <h1 class="text-2xl font-bold text-gray-900 dark:text-gray-100">Projects</h1>
    <button id="create-project-btn" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
      <i class="fas fa-plus mr-2"></i>
      New Project
    </button>
  </div>
  
  <!-- Project Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <!-- Empty State (placeholder for when there are no projects) -->
    <div class="col-span-full bg-white dark:bg-gray-800 rounded-lg shadow-md p-10 text-center">
      <div class="flex flex-col items-center">
        <div class="w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mb-4">
          <i class="fas fa-project-diagram text-gray-400 dark:text-gray-500 text-2xl"></i>
        </div>
        <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2">No projects yet</h2>
        <p class="text-gray-600 dark:text-gray-400 max-w-md mb-6">Projects help you organize your databases and resources. Create your first project to get started.</p>
        <button id="empty-create-project-btn" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
          <i class="fas fa-plus mr-2"></i>
          Create Your First Project
        </button>
      </div>
    </div>
    
    <!-- Project Card (Example - would be repeated for each project) -->
    <div class="hidden bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden">
      <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3 flex items-center justify-between">
        <h3 class="font-semibold text-gray-900 dark:text-gray-100">My Project</h3>
        <div class="flex space-x-1">
          <button class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
            <i class="fas fa-pencil-alt"></i>
          </button>
          <button class="text-red-500 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300">
            <i class="fas fa-trash-alt"></i>
          </button>
        </div>
      </div>
      <div class="p-4">
        <div class="text-sm text-gray-600 dark:text-gray-400 mb-4">
          A sample project for demonstration.
        </div>
        
        <div class="mb-4">
          <h4 class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">Databases</h4>
          <div class="space-y-2">
            <div class="flex items-center justify-between text-sm">
              <div class="flex items-center">
                <i class="fas fa-database text-blue-500 dark:text-blue-400 mr-2"></i>
                <span class="text-gray-800 dark:text-gray-200">customers</span>
              </div>
              <span class="px-2 py-0.5 rounded-full text-xs bg-blue-100 dark:bg-blue-900/20 text-blue-800 dark:text-blue-500">MySQL</span>
            </div>
            <div class="flex items-center justify-between text-sm">
              <div class="flex items-center">
                <i class="fas fa-database text-green-500 dark:text-green-400 mr-2"></i>
                <span class="text-gray-800 dark:text-gray-200">inventory</span>
              </div>
              <span class="px-2 py-0.5 rounded-full text-xs bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-500">PostgreSQL</span>
            </div>
          </div>
        </div>
        
        <div class="pt-3 border-t border-gray-200 dark:border-gray-700 flex justify-between">
          <span class="text-xs text-gray-500 dark:text-gray-400">Created: 2023-08-15</span>
          <button class="text-sm text-primary-600 dark:text-primary-500 hover:text-primary-800 dark:hover:text-primary-400">
            <i class="fas fa-external-link-alt mr-1"></i> View
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Create Project Modal -->
<div id="create-project-modal" class="hidden fixed inset-0 z-50 overflow-y-auto">
  <div class="flex items-center justify-center min-h-screen px-4">
    <div class="fixed inset-0 bg-gray-900 bg-opacity-50 transition-opacity"></div>
    
    <div class="relative bg-white dark:bg-gray-800 rounded-lg max-w-xl w-full shadow-xl transform transition-all">
      <!-- Modal Header -->
      <div class="bg-gray-50 dark:bg-gray-700 px-6 py-4 rounded-t-lg flex items-center justify-between">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Create New Project</h3>
        <button id="close-modal-btn" class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <!-- Modal Form -->
      <form id="create-project-form" class="p-6 space-y-6">
        <!-- Project Name -->
        <div>
          <label for="project_name" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Project Name</label>
          <div class="mt-1">
            <input type="text" id="project_name" name="project_name" class="block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 focus:border-primary-500 focus:ring-primary-500" placeholder="My Project" required>
          </div>
        </div>
        
        <!-- Project Description -->
        <div>
          <label for="project_description" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Description</label>
          <div class="mt-1">
            <textarea id="project_description" name="project_description" rows="3" class="block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 focus:border-primary-500 focus:ring-primary-500" placeholder="Describe your project..."></textarea>
          </div>
        </div>
        
        <!-- Associated Databases -->
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Associated Databases</label>
          
          <div class="space-y-4">
            <!-- MySQL Databases -->
            <div>
              <h4 class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">MySQL Databases</h4>
              <div class="max-h-40 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-md p-2">
                {% if mysql_dbs %}
                  <div class="space-y-2">
                    {% for db in mysql_dbs %}
                      <div class="flex items-center">
                        <input type="checkbox" id="mysql-{{ db }}" name="mysql_databases" value="{{ db }}" class="h-4 w-4 text-primary-600 rounded border-gray-300 focus:ring-primary-500">
                        <label for="mysql-{{ db }}" class="ml-3 block text-sm text-gray-700 dark:text-gray-300">{{ db }}</label>
                      </div>
                    {% endfor %}
                  </div>
                {% else %}
                  <div class="text-sm text-gray-500 dark:text-gray-400 p-2">
                    No MySQL databases available
                  </div>
                {% endif %}
              </div>
            </div>
            
            <!-- PostgreSQL Databases -->
            <div>
              <h4 class="text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">PostgreSQL Databases</h4>
              <div class="max-h-40 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-md p-2">
                {% if postgres_dbs %}
                  <div class="space-y-2">
                    {% for db in postgres_dbs %}
                      <div class="flex items-center">
                        <input type="checkbox" id="postgres-{{ db }}" name="postgres_databases" value="{{ db }}" class="h-4 w-4 text-primary-600 rounded border-gray-300 focus:ring-primary-500">
                        <label for="postgres-{{ db }}" class="ml-3 block text-sm text-gray-700 dark:text-gray-300">{{ db }}</label>
                      </div>
                    {% endfor %}
                  </div>
                {% else %}
                  <div class="text-sm text-gray-500 dark:text-gray-400 p-2">
                    No PostgreSQL databases available
                  </div>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
        
        <!-- Form Buttons -->
        <div class="pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3">
          <button type="button" id="cancel-project-btn" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700">
            Cancel
          </button>
          <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
            Create Project
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Modal Control
    const modal = document.getElementById('create-project-modal');
    const createProjectBtn = document.getElementById('create-project-btn');
    const emptyCreateProjectBtn = document.getElementById('empty-create-project-btn');
    const closeModalBtn = document.getElementById('close-modal-btn');
    const cancelProjectBtn = document.getElementById('cancel-project-btn');
    
    function openModal() {
      modal.classList.remove('hidden');
      document.body.classList.add('overflow-hidden');
    }
    
    function closeModal() {
      modal.classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
    }
    
    // Event Listeners
    createProjectBtn.addEventListener('click', openModal);
    emptyCreateProjectBtn.addEventListener('click', openModal);
    closeModalBtn.addEventListener('click', closeModal);
    cancelProjectBtn.addEventListener('click', closeModal);
    
    // Form Submission
    const projectForm = document.getElementById('create-project-form');
    projectForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // In a real application, this would submit to a server endpoint
      // For now, let's just show an alert
      const projectName = document.getElementById('project_name').value;
      const projectDescription = document.getElementById('project_description').value;
      
      const mysqlDbs = [];
      const postgresDbs = [];
      
      document.querySelectorAll('input[name="mysql_databases"]:checked').forEach(checkbox => {
        mysqlDbs.push(checkbox.value);
      });
      
      document.querySelectorAll('input[name="postgres_databases"]:checked').forEach(checkbox => {
        postgresDbs.push(checkbox.value);
      });
      
      alert(`Creating project: ${projectName}\nDescription: ${projectDescription}\nMySQL Databases: ${mysqlDbs.join(', ')}\nPostgreSQL Databases: ${postgresDbs.join(', ')}`);
      
      // Close the modal
      closeModal();
    });
  });
</script>
{% endblock %} 